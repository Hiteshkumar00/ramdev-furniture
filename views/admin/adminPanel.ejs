<% layout("/templates/boilerplate.ejs") %>

<!-- Bootstrap Icons -->

<div class="dashboard-container">
  <div class="card">
    <div class="card-header">
      <h4 class="card-title panel-title mb-0">Item List</h5>
    </div>
    <div class="card-body">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Image</th>
            <th>Price</th>
            <th>Actions</th>
            <th>Delete</th>
          </tr>
        </thead>
        <tbody>
          <% let i = 1; for(let item of items){ %>
          <tr>
            <td><%= i %></td>
            <td><%= item.name %></td>
            <td><img src="<%= item.image.url.replace("/upload", "/upload/q_10") %>" alt="Item Image" class="img-thumbnail"></td>
            <td>&#8377; <% if(item.price){ %><%= item.price %> <% } %></td>
            <td class="action-icons">
              <a href="/item/<%= item._id %>" class="show" title="View"><i class="fa-regular fa-eye"></i></a>
              <a href="/admin/item/edit/<%= item._id %>" class="edit" title="Edit"><i class="fa-regular fa-pen-to-square"></i></a> 
            </td>
            <td>
              <button value="/admin/item/destory/<%= item._id %>?_method=DELETE" class="btn delete-conform btn-outline-danger btn-sm"><i class="fa-solid fa-trash-can"></i></button>
            </td>
          </tr>
          <% i++ } %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- delete conform code -->
<style>
  .delete-form{
    position: fixed;
    top: 0px;
    left: 0px;
    height: 100vh;
    width: 100%;
    text-align: center;
    background-color: rgb(255, 255, 255, 0.8);
  }

</style>



<form class="delete-form" id="hidden-delete" method="post" hidden>
  <div class="category-btns position-absolute top-50 start-50 translate-middle">
    <p>Delete this item?</p>
    <button type="submit" class="btn hidden-delete btn-danger"><i class="fa-solid fa-trash-can"></i> Delete</button>
    &nbsp;&nbsp;
    <button type="button" id="hide-dismiss" class="btn btn-primary">&nbsp; No &nbsp;</button>
  </div>
</form> 


<script>

  let delete_btns = document.getElementsByClassName("delete-conform");
  let hidden_delete = document.getElementById("hidden-delete");
  let hide_dissmiss = document.getElementById("hide-dismiss");

  for(delete_btn of delete_btns){
    delete_btn.addEventListener("click", () => {
      let link = delete_btn.value;
      hidden_delete.action=link;
      hidden_delete.hidden = false;
    });
  };
  hide_dissmiss.addEventListener("click", () => {
    hidden_delete.hidden = true;
  });

</script>



